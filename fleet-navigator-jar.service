[Unit]
Description=Fleet Navigator - AI Chat Interface for Ollama (JAR)
Documentation=https://github.com/javafleet/fleet-navigator
After=network.target ollama.service
Wants=ollama.service

[Service]
Type=simple
User=trainer
Group=trainer
WorkingDirectory=/opt/fleet-navigator

# JAR Execution with optimized JVM flags
ExecStart=/usr/bin/java \
    -Xms256m \
    -Xmx512m \
    -XX:+UseG1GC \
    -XX:+UseStringDeduplication \
    -XX:MaxGCPauseMillis=200 \
    -Dspring.profiles.active=production \
    -Dserver.port=2025 \
    -jar /opt/fleet-navigator/fleet-navigator.jar

# Restart policy
Restart=on-failure
RestartSec=10s
StartLimitBurst=3
StartLimitInterval=60s

# Limits
LimitNOFILE=65536
LimitNPROC=4096

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=fleet-navigator

# Security Hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=read-only
ReadWritePaths=/opt/fleet-navigator/data /opt/fleet-navigator/logs
ProtectKernelTunables=true
ProtectControlGroups=true
RestrictRealtime=true
RestrictNamespaces=true

[Install]
WantedBy=multi-user.target
